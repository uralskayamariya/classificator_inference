# Инференс моделей классификации tensorflow и onnx
Данный репозиторий позволяет выполнять инференс моделей классификации изображений ResNet50.
Подходит для моделей tensorflow, обученных с препроцессингом tf.keras.applications.resnet50.preprocess_input() и нормализацией данных на 255.

Изображения в процессе инференса масштабируются до 224х224х3.

## Требования к компьютеру
<br>Репозиторий протестирован на Windows 10.
<br>Для поддержки GPU а компьютере должна быть установлена Cuda Toolkit 11.x (протестировано на версии 11.4) и CudNN.
<br>Для теста использовались видеокарты Nvidia GeForce GTX 1060, GTX 1660 Ti.

## Установка
1. Установите на компьютер менеджер виртуальных сред Anaconda.
2. В файле tf280gpu.yml с самой нижней строчке установите путь к виртуальным средам Anaconda, который используется на вашем компьютере.
3. Откройте командную строку Anaconda и импортируйте среду из файла tf280gpu.yml следующей командой: conda env create -f tf280gpu.yml.
<br>Установленная среда Anaconda содержит tensorflow-gpu 2.8.0.

## Входные данные
Для инференса необходимо указать путь к изображению, для которого необходимо выполнить инференс, а также путь к модели.
<br>Пути могут быть указаны как с помощью прямых, так и обратных слешей.

## Инференс моделей tensorflow
Для запуска инференса необходимо:
1. Открыть командную строку Anaconda со средой tf280gpu
2. Перейти в папку данного репозитория
3. Выполнить команду: python run.py
4. Указать пути к файлу изображения и к папке с моделью tensorflow.
5. После инференса на экране появляются предсказания модели.

## Инференс моделей onnx
Для запуска инференса необходимо:
1. Открыть командную строку Anaconda со средой tf280gpu
2. Перейти в папку данного репозитория
3. Выполнить команду: python run_onnx.py
4. Указать путь к файлу изображения и модели onnx.
5. После инференса на экране появляются предсказания модели.